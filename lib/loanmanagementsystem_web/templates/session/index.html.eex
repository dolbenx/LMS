<!DOCTYPE html>
<html lang="en">
   <head>
      <title>Loan | Login</title>
      <meta charset="utf-8">
      <meta name="viewport" content="initial-scale = 1.0,maximum-scale = 1.0" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
	  <!-- Favicon -->
	  <link rel="icon" href="<%= Routes.static_path(@conn, "/images/qfinrel.png") %>" type="image/x-icon"/>
      <!-- CSS only -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
      <style>
         html{
         height: 100vh;
         }

         body{
            background-color: #4DA8DF;
            width: 100%;
            height: 100vh;
            position: fixed;
            top: 0;
            bottom: 0;
            }
         /* Style the header */
         header {
         background-color: #666;
         padding: 30px;
         text-align: center;
         font-size: 35px;
         color: white;
         }
         /* Style the navigation menu */
         nav {
         -webkit-flex: 1;
         -ms-flex: 1;
         flex: 1;
         background: #ccc;
         padding: 20px;
         }
         /* Style the list inside the menu */
         nav ul {
         list-style-type: none;
         padding: 0;
         }
         /* Style the content */
         article {
         -webkit-flex: 3;
         -ms-flex: 3;
         flex: 3;
         background-color: #f1f1f1;
         padding: 10px;
         }
         /* Style the footer */
         footer {
         position: absolute;
         right: 0;
         bottom: 0;
         left: 0;
         padding: 3rem;
         background-color: #3B7CA2;
         color: white;
         }
         @media screen and (max-width: 1280px) and (max-height: 720px) {
               html {
                  transform: scale(.5);
                  // or simply zoom: 50%
               }
            }
         /* Responsive layout - makes the menu and the content (inside the section) sit on top of each other instead of next to each other */
         @media (max-width: 600px) {
         section {
            -webkit-flex-direction: column;
            flex-direction: column;
            }
         }
      @media only screen and (min-width: 1350px) {
         .logos{
            padding-left: 230px;
            padding-top: 222px;
            width: 72%;
         }
         .loginforms{
            display: block;
            margin-right: auto;
            padding-top: 103px;
            width: 72%;

         }
         img {
            width:600px
         }
      }
      @media only screen and (max-width: 1350px) {
         .loginforms{
            margin: auto;
            width: 60%;
            padding: 10px;
         }
         .logos{
            margin: auto;
            width: 50%;
            padding: 50px;
         }
         img {
            width:400px
         }
      }
      @media only screen and (max-width: 750px) {
         .fordesktop {
            display: none;
         }
         .loginforms{
            margin: auto;
            width: 100%;
            padding: 10px;
         }
         .logos{
            margin: auto;
            width: 100%;
         }
         img {
            width:300px
         }
      }
      </style>
   </head>
   <body>
    <div class="row">
        <div class="col-md-7">
            <div class="logos">
               <img src="<%= Routes.static_path(@conn, "/images/qfinnn.png") %>" alt="Italian Trulli">
			   </div>
        </div>
        <div class="col-md-5">
            <div class="loginforms">
				<div class="row">
					<div class="col-md-12 col-lg-offset-2">
						<div class="form-group">
							<%= if get_flash(@conn, :info) do %>
								<div class="alert alert-success alert-styled-left" style="border-radius: 15px">
								<button type="button" class="close" data-dismiss="alert">&times; <span class="sr-only">Close</span></button>
								<%= get_flash(@conn, :info) %>
								</div>
							<% end %>
							<%= if get_flash(@conn, :error) do %>
								<div class="alert alert-warning alert-styled-left" style="border-radius: 15px">
								<button type="button" class="close" data-dismiss="alert">&times; <span class="sr-only">Close</span></button>
								Sorry! <%= get_flash(@conn, :error) %>
								</div>
							<% end %>
						</div>
					</div>
				</div>
            	<span class="anchor" id="formLogin"></span>
               <!-- form card login -->
               	<div class="card card-outline-secondary" style="border-radius: 25px; height: 529px;">
			   		<br><br><br>
				  	<div class="container">
						<div class="card-body">
				  			<div class="container">
				  			<div class="container">
				  			<div class="container">
				  			<div class="container">
								<form autocomplete="off" class="form" action="<%= Routes.session_path(@conn, :create)%>" method="POST" id="formLogin" name="formLogin" role="form">
                    				<input type="hidden" name="_csrf_token" value="<%= Plug.CSRFProtection.get_csrf_token()%>">

									<div class="form-group">
									<label for="uname1" style="font-size: 20px; color: #4DA8DF;">Mobile Number</label> <br><br>
									<input class="form-control" id="uname1" name="username" style="background-color: #D4D4D4;" required="" placeholder="Enter Mobile Number" type="text">
									</div><br>
									<div class="form-group">
									<label style="font-size: 20px; color: #4DA8DF;">Password</label><br><br>
									<input autocomplete="new-password" name="password" style="background-color: #D4D4D4;" class="form-control" placeholder="Enter Password" id="pwd1" required="" type="password">
									</div><br><br>
									<div class="form-group">
										<button class="btn form-control btn-lg float-right" style="background-color: #4DA8DF; color: white; border-radius: 15px;">Login</button>
									</div><br><br>
									<div class="text-center">
										<p style="font-size: 20px; color: #4DA8DF;"><a href="#" style="color: #4DA8DF;">Forgot Pasword</a> | <a href="/Register" style="color: #4DA8DF;">Register</a> </p>
									</div>
								</form>
							</div>
                    <!-- <button type="button" class="btn btn-primary my-2 btn-icon-text "  data-bs-target="#modaldemo9" data-bs-toggle="modal"> <i class="fa fa-calculator me-2 russ_russ"></i> Loan Calculator </button> -->
							</div>
							</div>
							</div>
						</div>
					</div>
                  <!--/card-block-->
               </div>
               <!-- /form card login -->
            </div>
      	</div>
      	<!-- footer class="fordesktop">
			<div class="row text-center">
				<div class="col-md-2">
					<div class="row">
						<div class="col-md-2">
							<i class="fa fa-map-marker" style="font-size:40px;color:lightblue;text-shadow:2px 2px 4px #000000;"></i>
						</div>
						<div class="col-md-10">
							3A Joseph Mwilwa Road,<br>
							Rhodes Park, Lusaka,<br>
							Zambia
						</div>
					</div>
				</div>
				<div class="col-md-2">
				Enquiry<br>
				info@qfin.co.zm<br>
				www.qfin.co.zm
				</div>
				<div class="col-md-2">
					<div class="row">
						<div class="col-md-2">
							<i class="fa fa-at" style="font-size:40px;color:lightblue;text-shadow:2px 2px 4px #000000;"></i>
						</div>
						<div class="col-md-10">
							Qfin Credit Limited<br>
							+260 975487574<br>
							info@qfin.co.zm<br>
							www.qfin.co.zm
						</div>
					</div>
				</div>
				<div class="col-md-2">
				Support<br>
				info@qfin.co.zm<br>
				www.qfin.co.zm
				</div>
				<div class="col-md-4">
				<i class="fa fa-facebook" style="font-size:40px;color:lightblue;text-shadow:2px 2px 4px #000000;"></i> &nbsp;&nbsp;<i class="fa fa-instagram" style="font-size:40px;color:lightblue;text-shadow:2px 2px 4px #000000;"></i> &nbsp;&nbsp;<i class="fa fa-twitter" style="font-size:40px;color:lightblue;text-shadow:2px 2px 4px #000000;"></i> &nbsp;&nbsp;|&nbsp;&nbsp; <i style="font-size: 35px;"> www.qfin.co.zm </i>
				</div>
			</div>
      	</footer -->



      <div class="modal fade" id="modaldemo9" style="display: none;" aria-hidden="true">
	<div class="modal-dialog modal-xl" role="document">
		<div class="modal-content modal-content-demo">
			<div class="modal-header">
				<h6 class="modal-title">Loan Calculator</h6>
				<button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-sm-12 col-md-4 col-lg-4 col-xl-4">
						<div class="card custom-card">
							<div class="card-body">
								<div class="card-item">
									<div class="card-item-title mb-2">
										<label class="main-content-label tx-13 font-weight-bold mb-1">Loan Calculator</label>
										<span class="d-block tx-12 mb-0 text-muted">Enter Ammount</span>
									</div>
									<form>
									<div class="row">
										<div class="form-group col-md-6">
											<p class="mg-b-10">Principal</p>
											<input type="text" class="form-control"  id="principal" name="example-text-input">
										</div>
										<div class="form-group col-md-6">
											<p class="mg-b-10">Interest(%)</p>
											<input type="text" class="form-control" id="interest" name="example-text-input">
										</div>
											<p class="mg-b-10">Terms </p><p id="rangevalue1">  </p> (months)
											<input class="range" type="range"  id="terms" min="12" max="100" value="10" step="1" onmousemove="rangevalue1.value=value" /><br><br><br>


										<div class="form-group col-md-12 text-right">
											<input type="button" class ="btn btn-primary" value="Calculate" onclick="getValues()" />
										</div>

									</div>
									</form>
								</div>
							</div>
						</div>
					</div>
					<div class="col-sm-12 col-md-8 col-lg-8 col-xl-8">
						<div class="card custom-card">
							<div class="card-body">
								<div class="card-item">
									<div class="card-item-title mb-2">
										<label class="main-content-label tx-13 font-weight-bold mb-1">Amortization Calculation Results</label>
										<span class="d-block tx-12 mb-0 text-muted">Previous month vs this months</span>
									</div>
									<form>
										<div id="Result"></div>
									</form>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button class="btn ripple btn-danger" data-bs-dismiss="modal" type="button">Close</button>
			</div>
		</div>
	</div>
</div>

      <!-- JavaScript Bundle with Popper -->
      <script src="<%= Routes.static_path(@conn, "/webstatic/plugins/jquery/jquery.min.js") %> "></script>

		<!-- Bootstrap js-->
		<script src="<%= Routes.static_path(@conn, "/webstatic/plugins/bootstrap/js/popper.min.js") %> "></script>
		<script src="<%= Routes.static_path(@conn, "/webstatic/plugins/bootstrap/js/bootstrap.min.js") %> "></script>

		<!-- Select2 js-->
		<script src="<%= Routes.static_path(@conn, "/webstatic/plugins/select2/js/select2.min.js") %> "></script>
		<script src="<%= Routes.static_path(@conn, "/webstatic/js/select2.js") %> "></script>

		<!-- Custom js -->
		<script src="<%= Routes.static_path(@conn, "/webstatic/js/custom.js") %> "></script>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>

   <script>

function getValues()
{
	//button click gets values from inputs
   var balance = parseFloat(document.getElementById("principal").value);
	var interestRate = parseFloat(document.getElementById("interest").value/100.0);
	var terms = parseInt(document.getElementById("terms").value);

	//set the div string
	var div = document.getElementById("Result");

	//in case of a re-calc, clear out the div!
	div.innerHTML = "";

	//validate inputs - display error if invalid, otherwise, display table
	var balVal = validateInputs(balance);
	var intrVal = validateInputs(interestRate);

	if (balVal && intrVal)
	{
		//Returns div string if inputs are valid
		div.innerHTML += amort(balance, interestRate, terms);
	}
	else
	{
		//returns error if inputs are invalid
		div.innerHTML += "Please Check your inputs and retry - invalid values.";
	}
}

/**
 * Amort function:
 * Calculates the necessary elements of the loan using the supplied user input
 * and then displays each months updated amortization schedule on the page
*/
function amort(balance, interestRate, terms)
{
    //Calculate the per month interest rate
	var monthlyRate = interestRate/12;

	//Calculate the payment
    var payment = balance * (monthlyRate/(1-Math.pow(1+monthlyRate, -terms)));

	//begin building the return string for the display of the amort table
    var result = "<div class='row'><div class='form-group col-md-4'><p class='mg-b-10'>Loan Amount:</p> <input class='form-control' value="+'ZMW' + balance.toFixed(2) +"  type='text'></div>" +
		"<div class='form-group col-md-4'><p class='mg-b-10'>Interest Rate:</p> <input class='form-control' value="+ (interestRate*100).toFixed(2) + '%'+ "  type='text'></div>" +
		"<div class='form-group col-md-4'><p class='mg-b-10'>Number of Months:</p> <input class='form-control' value=" + terms + "  type='text'></div>" +
		"<div class='form-group col-md-4'><p class='mg-b-10'>Monthly Payment:</p> <input class='form-control' value="+ payment.toFixed(2) +"  type='text'></div>" +
		"<div class='form-group col-md-4'><p class='mg-b-10'>Total Repayment:</p> <input class='form-control' value="+'ZMW' + (payment * terms).toFixed(2) +"  type='text'></div></div>";

    //add header row for table to return string
	result += "<table align=center class='table  text-nowrap text-md-nowrap table-striped mg-b-0'><tr><th>Month #</th><th>Balance</th>" +
        "<th>Interest</th><th>Principal</th>";

    /**
     * Loop that calculates the monthly Loan amortization amounts then adds
     * them to the return string
     */
	for (var count = 0; count < terms; ++count)
	{
		//in-loop interest amount holder
		var interest = 0;

		//in-loop monthly principal amount holder
		var monthlyPrincipal = 0;

		//start a new table row on each loop iteration
		result += "<tr>";

		//display the month number in col 1 using the loop count variable
		result += "<td>" + (count + 1) + "</td>";


		//code for displaying in loop balance
		result += "<td> K" + balance.toFixed(2) + "</td>";

		//calc the in-loop interest amount and display
		interest = balance * monthlyRate;
		result += "<td> K" + interest.toFixed(2) + "</td>";

		//calc the in-loop monthly principal and display
		monthlyPrincipal = payment - interest;
		result += "<td> K" + monthlyPrincipal.toFixed(2) + "</td>";

		//end the table row on each iteration of the loop
		result += "</tr>";

		//update the balance for each loop iteration
		balance = balance - monthlyPrincipal;
	}

	//Final piece added to return string before returning it - closes the table
    result += "</table>";

	//returns the concatenated string to the page
    return result;
}

function validateInputs(value)
{
	//some code here to validate inputs
	if ((value == null) || (value == ""))
	{
		return false;
	}
	else
	{
		return true;
	}
}
</script>


   </body>
</html>
