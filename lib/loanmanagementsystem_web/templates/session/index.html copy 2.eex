<!DOCTYPE html>
<html lang="en">
	<head>

		<meta charset="utf-8">
		<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
		<meta name="description" content="Spruha -  Admin Panel HTML Dashboard Template">
		<meta name="author" content="Spruko Technologies Private Limited">
		<meta name="keywords" content="admin,dashboard,panel,bootstrap admin template,bootstrap dashboard,dashboard,themeforest admin dashboard,themeforest admin,themeforest dashboard,themeforest admin panel,themeforest admin template,themeforest admin dashboard,cool admin,it dashboard,admin design,dash templates,saas dashboard,dmin ui design">

		<!-- Favicon -->
		<link rel="icon" href="../../assets/img/brand/favicon.ico" type="image/x-icon"/>

		<!-- Title -->
		<title>Loan Management System</title>

		<!-- Bootstrap css-->
	<link  id="style" rel="stylesheet" href="<%= Routes.static_path(@conn, "/webstatic/plugins/bootstrap/css/bootstrap.min.css") %>">
	<link  rel="stylesheet" media="screen, print" href="<%= Routes.static_path(@conn, "/webstatic/css/notifications/sweetalert2/sweetalert2.bundle.css") %>">

	<!-- Internal Ion.rangeslider css-->
	<link  href="<%= Routes.static_path(@conn, "/webstatic/plugins/ion-rangeslider/css/ion.rangeSlider.css") %>" rel="stylesheet">
	<link  href="<%= Routes.static_path(@conn, "/webstatic/plugins/ion-rangeslider/css/ion.rangeSlider.skinFlat.css") %>" rel="stylesheet">


	<!-- Icons css-->
	<link rel="stylesheet" href="<%= Routes.static_path(@conn, "/webstatic/plugins/web-fonts/icons.css") %>">
	<link rel="stylesheet" href="<%= Routes.static_path(@conn, "/webstatic/plugins/web-fonts/font-awesome/font-awesome.min.css") %>">
	<link rel="stylesheet" href="<%= Routes.static_path(@conn, "/webstatic/plugins/web-fonts/plugin.css") %>">

	<!-- Style css-->
	<link rel="stylesheet" href="<%= Routes.static_path(@conn, "/webstatic/css/style.css") %>">
	<link rel="stylesheet" href="<%= Routes.static_path(@conn, "/webstatic/css/boxed.css") %>">
	<link rel="stylesheet" href="<%= Routes.static_path(@conn, "/webstatic/css/dark-boxed.css") %>">
	<link rel="stylesheet" href="<%= Routes.static_path(@conn, "/webstatic/css/skins.css") %>">
	<link rel="stylesheet" href="<%= Routes.static_path(@conn, "/webstatic/css/dark-style.css") %>">
	<link rel="stylesheet" href="<%= Routes.static_path(@conn, "/webstatic/css/colors/default.css") %>">
		<!-- Color css-->
		<!-- Color css-->
	<link id="theme" rel="stylesheet" type="text/css" media="all" href="<%= Routes.static_path(@conn, "/webstatic/css/colors/color.css") %>">

	<style>
		.russ{
		width: 100px;
		height: 50px;
		position: relative;
		animation-name: example;
		animation-duration: 2s;
		}

		@keyframes example {
		0%   {left:25px; top:0px;}
		25%  {left:200px; top:0px;}

		60% {left:0px; top:0px;}
		}

		.russkay{
		width: 100px;
		height: 100px;
		position: relative;
		animation-name: example;
		animation-duration: 4s;

		}

		@keyframes example {
		0%   {left:25px; top:0px;}
		25%  {left:200px; top:0px;}

		60% {left:0px; top:0px;}
		}

			.russ_russ{
		position: relative;
		animation-name: example;
		animation-duration: 2s;
		}

		.ui-slider {
			margin:20px;
			width: 300px;
		}

		h1 {
		font-size: 1.3em;
		font-weight:900;
		}

	</style>
	</head>


	</head>

	<body style="background: url(/images/img/brand/abstract-blue-line-4k-xh.jpg) no-repeat center bottom fixed; background-size: cover; " >


		<!-- Loader -->
		<div id="global-loader">
			<img src="<%= Routes.static_path(@conn, "/images/img/loader.svg") %>" class="loader-img" alt="Loader">
		</div>
		<!-- End Loader -->

		<!-- Page -->
		<div class="page main-signin-wrapper" >

		<form action="<%= Routes.session_path(@conn, :create)%>" method="POST">
                    <input type="hidden" name="_csrf_token" value="<%= Plug.CSRFProtection.get_csrf_token()%>">

			<!-- Row -->
			<div class="row signpages text-center">


				<div class="col-md-12">

						<div class="row row-sm">
							<div class="col-lg-6 col-xl-5 d-none d-lg-block text-center bg-primary details">
								<div class="mt-8 pt-4 p-2 pos-absolute">
									<div class="clearfix"></div>
									<img src="<%= Routes.static_path(@conn, "/images/load.png") %>" class="ht-100 mb-0" alt="user"><br><br><br>
									<h5 class="mt-4 text-white">LOAN MANAGEMENT SYSTEM</h5>
									<span class="tx-white-6 tx-13 mb-5 mt-xl-0">Register to get best loans with flexiable repayment terms</span>
								</div>
							</div>
							<div class="col-lg-6 col-xl-7 col-xs-12 col-sm-12 login_form ">
								<div class="container-fluid">
										<div class="card-body mt-2 mb-2">
											<img src="<%= Routes.static_path(@conn, "/images/load.png") %>" class=" d-lg-none header-brand-img text-start float-start mb-4" alt="logo">
											<div class="clearfix"></div>
											<form>
												<h5 class="text-start mb-2 text-center">Sign In</h5><br>
													<div class="row">
														<div class="col-md-12 col-lg-offset-2">
															<div class="form-group">
																<%= if get_flash(@conn, :info) do %>
																	<div class="alert alert-success alert-styled-left">
																	<button type="button" class="close" data-dismiss="alert">&times; <span class="sr-only">Close</span></button>
																	<%= get_flash(@conn, :info) %>
																	</div>
																<% end %>
																<%= if get_flash(@conn, :error) do %>
																	<div class="alert alert-warning alert-styled-left">
																	<button type="button" class="close" data-dismiss="alert">&times; <span class="sr-only">Close</span></button>
																	Opps! <%= get_flash(@conn, :error) %>
																	</div>
																<% end %>
															</div>
														</div>
													</div>
												<div class="form-group text-start">
													<label>Username</label>
													<input class="form-control" name="username" placeholder="Enter your username" type="text">
												</div>
												<div class="form-group text-start">
													<label>Password</label>
													<input class="form-control" placeholder="Enter your password" name="password" type="password">
												</div>
												<button class="btn ripple btn-main-primary btn-block">Sign In</button>

												<button type="button" class="btn btn-primary my-2 btn-icon-text "  data-bs-target="#modaldemo9" data-bs-toggle="modal"> <i class="fa fa-calculator me-2 russ_russ"></i> Loan Calculator </button>
											</form>
											<div class="text-start mt-5 ms-0">
												<div class="mb-1 text-center"><a href="#">Forgot password?</a></div>
												<div class="text-center">Don't have an account? <a href="/Register">Register Here</a></div>
											</div>
										</div>
								</div>
							</div>

					</div>
				</div>
			</div>
			<!-- End Row -->
			<div class="blankpage-footer text-center text-white">
				©  <%= Timex.today.year %> Loan System powered by&nbsp;
				<a href='http://www.probasegroup.com/' class='text-black' title='ProBASE' target='_blank'>
					<img class="russ" src="<%= Routes.static_path(@conn, "/images/probaselogo.png") %>" width="120">
				</a>
			</div>
		</form>
		</div>

		<!-- Main Footer-->

		<!--End Footer-->



<div class="modal fade" id="modaldemo9" style="display: none;" aria-hidden="true">
	<div class="modal-dialog modal-xl" role="document">
		<div class="modal-content modal-content-demo">
			<div class="modal-header">
				<h6 class="modal-title">Loan Calculator</h6>
				<button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-sm-12 col-md-4 col-lg-4 col-xl-4">
						<div class="card custom-card">
							<div class="card-body">
								<div class="card-item">
									<div class="card-item-title mb-2">
										<label class="main-content-label tx-13 font-weight-bold mb-1">Loan Calculator</label>

									</div>
									<form>
									<div class="row">
										<div class="col-md-12">
										<h5>What you can get?</h5>
										<p><li>Quick Advance is a pay day advance designed for employees under the MOU Scheme.</li></p>
										</br>
									</div>
									<div class="col-md-12">

										<h5>What you’ll need?</h5>
											<h6><i class="mdi mdi-account-card-details"></i>  NRC</h6>
											<h6><i class="fa fa-bank"></i>  Latest Payslip</h6>
											<h6><i class="fa fa-newspaper"></i>  Latest Bank Statement</h6>
											<h6><i class="si si-note"></i>  Letter of Introduction from Employer</h6>
									</div>
									<div class="col-md-12">
									<h5>How to apply?</h5>

										<li style="list-style: none;">
											<ul class="list-group">
												<li class="listorder">Choose the amount you need </li>
												<li class="listorder">Choose how long you will need to repay</li>
												<li class="listorder">Click "Apply Now" and proceed to finalise your loan</li>
											</ul>
										</li>
									</div>

									</div>
									</form>
								</div>
							</div>
						</div>
					</div>
					<div class="col-sm-12 col-md-8 col-lg-8 col-xl-8">
						<div class="card custom-card">
							<div class="card-body">
									<div class="card-item">
										<div class="clearfix"></div>

												<div class="row">
													<div class="col-md-6">
												Your Loan <input type="text" id="amount" value="100"/><br /><br />
													</div>
													<div class="col-md-6">
													Days Loaned <input type="text" id="days" value="1"/><br /><br />
													</div>
												</div>


												Loan Amount<div class="rangeslider1" id="slider1"></div>

												Loan Length<div class="rangeslider1" id="slider2"></div>

												<div class="row">
													<div class="col-md-3">
													Total Loan <input id="amount2" type="text" />
													</div>
													<div class="col-md-3">
													  Repayment Date<br /><div id="date"> </div><br />
													</div>
													<div class="col-md-3">
													Interest <input id="amount3" type="text" /><br />
													</div>
													<div class="col-md-3">
														APR <input id="amount4" type="text" /><br />
													</div>
												</div>

												<div class="text-start mt-5 ms-0">
													<div class="mb-1 text-center"><a href="#">Forgot password?</a></div>
													<div class="text-center">Don't have an account? <a href="/Register">Register Here</a></div>
												</div>
										</div>
										<div class="modal-footer">
											<button class="btn ripple btn-danger" data-bs-dismiss="modal" type="button">Close</button>
										</div>
									</div>
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>
</div>



		<!-- End Page -->

		<!-- Jquery js-->
		<script src="<%= Routes.static_path(@conn, "/webstatic/plugins/jquery/jquery.min.js") %> "></script>

		<!-- Bootstrap js-->
		<script src="<%= Routes.static_path(@conn, "/webstatic/plugins/bootstrap/js/popper.min.js") %> "></script>
		<script src="<%= Routes.static_path(@conn, "/webstatic/plugins/bootstrap/js/bootstrap.min.js") %> "></script>

		<!-- Select2 js-->
		<script src="<%= Routes.static_path(@conn, "/webstatic/plugins/select2/js/select2.min.js") %> "></script>
		<script src="<%= Routes.static_path(@conn, "/webstatic/js/select2.js") %> "></script>

		<!-- Custom js -->
		<script src="<%= Routes.static_path(@conn, "/webstatic/js/custom.js") %> "></script>



	 <link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/resources/demos/style.css">
  <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
  <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
  	<!-- Internal Ion-rangeslider js-->
		<script src="<%= Routes.static_path(@conn, "/webstatic/plugins/ion-rangeslider/js/ion.rangeSlider.min.js") %>"></script>



<script>

function getValues()
{
	//button click gets values from inputs
	var balance = parseFloat(document.getElementById("principal").value);
	var interestRate =
		parseFloat(document.getElementById("interest").value/100.0);
	var terms = parseInt(document.getElementById("terms").value);

	//set the div string
	var div = document.getElementById("Result");

	//in case of a re-calc, clear out the div!
	div.innerHTML = "";

	//validate inputs - display error if invalid, otherwise, display table
	var balVal = validateInputs(balance);
	var intrVal = validateInputs(interestRate);

	if (balVal && intrVal)
	{
		//Returns div string if inputs are valid
		div.innerHTML += amort(balance, interestRate, terms);
	}
	else
	{
		//returns error if inputs are invalid
		div.innerHTML += "Please Check your inputs and retry - invalid values.";
	}
}

/**
 * Amort function:
 * Calculates the necessary elements of the loan using the supplied user input
 * and then displays each months updated amortization schedule on the page
*/
function amort(balance, interestRate, terms)
{
    //Calculate the per month interest rate
	var monthlyRate = interestRate/12;

	//Calculate the payment
    var payment = balance * (monthlyRate/(1-Math.pow(
        1+monthlyRate, -terms)));

	//begin building the return string for the display of the amort table
    var result = "<div class='row'><div class='form-group col-md-4'><p class='mg-b-10'>Loan Amount:</p> <input class='form-control' value="+'ZMW' + balance.toFixed(2) +"  type='text'></div>" +
		"<div class='form-group col-md-4'><p class='mg-b-10'>Interest Rate:</p> <input class='form-control' value="+ (interestRate*100).toFixed(2) + '%'+ "  type='text'></div>" +
		"<div class='form-group col-md-4'><p class='mg-b-10'>Number of Months:</p> <input class='form-control' value=" + terms + "  type='text'></div>" +
		"<div class='form-group col-md-4'><p class='mg-b-10'>Monthly Payment:</p> <input class='form-control' value="+ payment.toFixed(2) +"  type='text'></div>" +
		"<div class='form-group col-md-4'><p class='mg-b-10'>Total Repayment:</p> <input class='form-control' value="+'ZMW' + (payment * terms).toFixed(2) +"  type='text'></div></div>";

    //add header row for table to return string
	result += "<table align=center class='table  text-nowrap text-md-nowrap table-striped mg-b-0'><tr><th>Month #</th><th>Balance</th>" +
        "<th>Interest</th><th>Principal</th>";

    /**
     * Loop that calculates the monthly Loan amortization amounts then adds
     * them to the return string
     */
	for (var count = 0; count < terms; ++count)
	{
		//in-loop interest amount holder
		var interest = 0;

		//in-loop monthly principal amount holder
		var monthlyPrincipal = 0;

		//start a new table row on each loop iteration
		result += "<tr>";

		//display the month number in col 1 using the loop count variable
		result += "<td>" + (count + 1) + "</td>";


		//code for displaying in loop balance
		result += "<td> K" + balance.toFixed(2) + "</td>";

		//calc the in-loop interest amount and display
		interest = balance * monthlyRate;
		result += "<td> K" + interest.toFixed(2) + "</td>";

		//calc the in-loop monthly principal and display
		monthlyPrincipal = payment - interest;
		result += "<td> K" + monthlyPrincipal.toFixed(2) + "</td>";

		//end the table row on each iteration of the loop
		result += "</tr>";

		//update the balance for each loop iteration
		balance = balance - monthlyPrincipal;
	}

	//Final piece added to return string before returning it - closes the table
    result += "</table>";

	//returns the concatenated string to the page
    return result;
}

function validateInputs(value)
{
	//some code here to validate inputs
	if ((value == null) || (value == ""))
	{
		return false;
	}
	else
	{
		return true;
	}
}
</script>

<script>
$( document ).ready(function() {
function update() {
     $interest = 0.15 ;
     $perday = 15 ;
     $amount1 = $("#amount").val();
     $dayscount = $("#days").val();
     $amount2 = parseInt($amount1) + $interest * parseInt($amount1) + (parseInt($dayscount) * ($perday/100));
     $apr = (($amount2-$amount1 / $amount1 ) / ((parseInt($dayscount)/365) * 10000))  ;
     $("#amount2").val($amount2);
     $("#amount3").val(parseFloat($amount2-$amount1).toFixed(2));
     $("#amount4").val($apr);
}

debugger;

$("#slider1").slider({
    max:350,
    min:100,
    step:10,
    slide: function(event, ui) {

        $("#amount").val(ui.value);
                update();

    }
});



function addDaysToDate(days) {
  var mths = new Array("Jan", "Feb", "Mar",
    "Apr", "May", "Jun", "Jul", "Aug", "Sep",
    "Oct", "Nov", "Dec");

  var d = new Date();
  d.setHours(d.getHours() + (24 * days));

  var currD = d.getDate();
  var currM = d.getMonth();
  var currY = d.getFullYear();

  return mths[currM] + " " + currD + ", " + currY;
}



$("#slider2").slider({
    max:30,
    min:1,

    slide: function(event, ui) {

        $("#days").val(ui.value);
        $("#date").text(addDaysToDate(parseInt($("#days").val())));
                update();
    },
    create: function(event, ui) {
      $("#date").text(addDaysToDate(parseInt($("#days").val())));
    }
});

$("#days").val($("#slider2").slider("value"));

$("#days").change(function(event) {
  var data = $("#days").val();
  if (data.length > 0)
  {
     if (parseInt(data) >= 0 && parseInt(data) <= 31)
    {
        $("#slider2").slider("option", "value", data);
     }
     else
     {
        if (parseInt(data) < 1)
       {
           $("#days").val("1");
           $("#slider2").slider("option", "value", "1");
       }
       if (parseInt(data) > 31)
        {
            $("#days").val("31");
            $("#slider2").slider("option", "value", "31");
        }
     }
  }
  else
  {
    $("#slider2").slider("option", "value", "1");
  }
  $("#date").text(addDaysToDate(parseInt($("#days").val())));
});

update();
});
</script>


	</body>
</html>
